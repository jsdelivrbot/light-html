"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const eventsList=["onclick","ondblclick","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseover","onmouseout","onmouseup","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload"],checkIfContains=(e,t)=>{switch(e){case"eventListeners":return eventsList.find(e=>t.search(e)>0)}},UUID=()=>{let e=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return"p"+(e()+e())+"-"+e()};String.prototype.html=function(){return(new DOMParser).parseFromString(this,"text/html").body.firstChild},String.prototype.svg=function(){return(new DOMParser).parseFromString(this,"image/svg+xml").documentElement};class Parser{constructor(e,t){this.valuesMap=[],this.rawDom=this.createHTML(e,t)}addId(e,t){return`${e}" ${t} "`}addTemplate(e,t){return`${e} <template ${t}> </template>`}createHTML(e,t){return e.map((e,r)=>{const s=UUID(),n=t[r];let o=checkIfContains("eventListeners",e);return o?(e=this.addId(e,s),this.valuesMap.push({id:s,value:n,param:o,type:"eventListeners"}),e):"string"==typeof n||"number"==typeof n?e=`${e}${n}`:(n&&(e=this.addTemplate(e,s),this.valuesMap.push({id:s,value:n,type:typeof n})),e)}).reduce((e,t)=>e+t).html()}putValuesToCorrectPlaces(e,t){for(let r of t){let t=r.id,s=r.value,n=r.type,o=e.parentNode.querySelector(`*[${t}]`);switch(!0){case 1==s.nodeType:o.replaceWith(s);break;case"eventListeners"==n:o[r.param]=s;break;case Array.isArray(s):let e=document.createDocumentFragment();s.forEach(t=>{1==!t.nodeType&&(t=t.html()),e.appendChild(t)}),o.replaceWith(e)}}return e}getHTML(){return this.putValuesToCorrectPlaces(this.rawDom,this.valuesMap)}getSVG(){let e=this.putValuesToCorrectPlaces(this.rawDom,this.valuesMap);return e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.outerHTML.svg()}}class ELEMENT{constructor(e,t,r){return this.values=t,this.strings=e,this.type=r,this.dom=this.parseHTML(),this.dom}render(e){e.appendChild(this)}update(e){e.render=this.render,e.update=this.update.bind(this),this.dom.replaceWith(e)}remove(){this.dom.remove()}parseHTML(){let{values:e,strings:t,type:r}=this,s=new Parser(t,e),n="HTML"==r?s.getHTML():s.getSVG();return this.attachFunctionsToDom(n),n}attachFunctionsToDom(e){e.render=this.render,e.update=this.update.bind(this)}}const HTML=(e,...t)=>{let r=[...t];return new ELEMENT(e,r,"HTML")},SVG=(e,...t)=>{let r=[...t];return new ELEMENT(e,r,"SVG")};exports.HTML=HTML,exports.SVG=SVG;
