"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const eventsList=["onclick","ondblclick","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseover","onmouseout","onmouseup","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload"],attributesList=["placeholder","value","x1","x2","y1","y2"],checkIfContains=(e,t)=>{switch(e){case"eventListeners":return eventsList.find(e=>t.search(e)>0);case"attributes":return attributesList.find(e=>t.search(e)>0)}},UUID=()=>{let e=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return"p"+(e()+e())+"-"+e()};String.prototype.html=function(){return(new DOMParser).parseFromString(this,"text/html").body.firstChild},String.prototype.svg=function(){return(new DOMParser).parseFromString(this,"image/svg+xml").documentElement};class Parser{constructor(e,t){this.valuesMap=[],this.rawDom=this.createHTML(e,t)}addId(e,t){return`${e}" data-${t}="`}addTemplate(e,t){return`${e} <template data-${t}=""> </template>`}createHTML(e,t){return e.map((s,r)=>{const a=UUID(),n=r+1!=e.length,i=t[r];if(n){let e=checkIfContains("eventListeners",s);if(e)s=this.addId(s,a),this.valuesMap.push({id:a,value:i,param:e,type:"eventListeners"});else if("string"==typeof i||"number"==typeof i){let e=checkIfContains("attributes",s);e?(s=this.addId(s,a),this.valuesMap.push({id:a,value:i,param:e,type:"attribute"})):(s=this.addTemplate(s,a),this.valuesMap.push({id:a,value:i,type:"value"}))}else s=this.addTemplate(s,a),this.valuesMap.push({id:a,value:i})}return s}).reduce((e,t)=>e+t).html()}putValuesToCorrectPlaces(e,t){for(let s of t){let t=s.id,r=s.value,a=s.type,n=e.parentNode.querySelector(`*[data-${t}]`);switch(!0){case"value"==a||"attribute"==a:"value"==a?n.parentNode.innerHTML=r:"attribute"==a&&n.setAttribute(s.param,s.value);break;case 1==r.nodeType:n.replaceWith(r);break;case"eventListeners"==a:n[s.param]=r;break;case Array.isArray(r):let e=document.createDocumentFragment();r.forEach(t=>{1==!t.nodeType&&(t=t.html()),e.appendChild(t)}),n.replaceWith(e)}}return e}getHTML(){return this.putValuesToCorrectPlaces(this.rawDom,this.valuesMap)}getSVG(){let e=this.putValuesToCorrectPlaces(this.rawDom,this.valuesMap);return e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.outerHTML.svg()}}class ELEMENT{constructor(e,t,s){return this.values=t,this.strings=e,this.type=s,this.dom=this.parseHTML(),this.dom}render(e){e.appendChild(this)}update(e){this.dom.replaceWith(e)}remove(){this.dom.remove()}parseHTML(){let{values:e,strings:t,type:s}=this,r=new Parser(t,e),a="HTML"==s?r.getHTML():r.getSVG();return this.attachFunctionsToDom(a),a}attachFunctionsToDom(e){e.render=this.render,e.update=this.update.bind(this)}}const HTML=(e,...t)=>{let s=[...t];return new ELEMENT(e,s,"HTML")},SVG=(e,...t)=>{let s=[...t];return new ELEMENT(e,s,"SVG")};"undefined"!=typeof module&&void 0!==module.exports&&(window.HTML=HTML,window.SVG=SVG),exports.HTML=HTML,exports.SVG=SVG;
